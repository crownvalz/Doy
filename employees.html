<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HR System Home Page</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        /* Stylish custom color theme */
        body {
            background-color: #f0f2f5;
            color: #333;
        }

        /* Navbar styling */
        .navbar {
            background-color: #2b2d42;
        }

        .navbar-brand {
            font-size: 1.5rem;
            font-weight: bold;
            color: #edf2f4 !important;
        }

        .navbar-nav .nav-link {
            color: #edf2f4 !important;
            margin-left: 1rem;
        }

        .navbar-toggler-icon {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23edf2f4' viewBox='0 0 30 30'%3E%3Cpath stroke='%23edf2f4' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3E%3C/svg%3E");
        }

        /* Hero Section Styling */
        .hero-section {
            background: linear-gradient(135deg, #8d99ae 40%, #2b2d42 100%);
            color: white;
            padding: 4rem 0;
            text-align: center;
        }

        .hero-section h1 {
            font-size: 3rem;
        }

        .hero-section .btn-primary {
            background-color: #ef233c;
            border-color: #ef233c;
        }

        /* Card styling */
        .card {
            border: none;
            border-radius: 15px;
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
        }

        .card:hover {
            transform: scale(1.05);
            transition: all 0.3s ease;
        }

        .btn-outline-primary {
            color: #ef233c;
            border-color: #ef233c;
        }

        .btn-outline-primary:hover {
            background-color: #ef233c;
            color: white;
        }

        /* Profile Picture in Navbar */
        .navbar-profile {
            display: flex;
            align-items: center;
            margin-left: 1rem;
        }

        .navbar-profile img {
            border-radius: 50%;
            width: 40px;
            height: 40px;
            margin-right: 10px;
        }

        /* Progress Bar Styling */
        .progress-bar {
            background-color: #ef233c;
        }

        /* Footer Styling */
        footer {
            background-color: #2b2d42;
            color: white;
            padding: 2rem 0;
        }

        footer a {
            color: #edf2f4;
            text-decoration: none;
        }

        footer a:hover {
            text-decoration: underline;
        }
    </style>
</head>

<body>

    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">HR System</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse text-center" id="navbarNav">
              <ul class="navbar-nav ms-auto d-flex align-items-center">
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                        <img src="https://via.placeholder.com/40" alt="Profile Image" class="rounded-circle me-2">
                        John Doe
                    </a>
                    <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                        <li><a class="dropdown-item" href="profileEdit.html">Profile</a></li>
                        <li><a class="dropdown-item" href="#">Settings</a></li>
                        <li><a class="dropdown-item" href="#">My Resume</a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item" id="logoutBtn">Logout</a></li>
                    </ul>
                </li>
            </ul>
                <div class="navbar-profile">
                    <a href="#" class="nav-link text-white">
                        <i class="bi bi-bell"></i>
                    </a>
                    <a href="#" class="nav-link text-white">
                        <i class="bi bi-gear"></i>
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Employee Table Section -->
    <section class="py-5">
        <div class="container">
            <h2 class="section-title text-center">Employee on leave</h2>
            <div class="table-responsive">
                <table class="table table-bordered table-hover">
                    <thead class="table-primary">
                        <tr>
                            <th>Job ID</th>
                            <th>Job Title</th>
                            <th>Company</th>
                            <th>Location</th>
                            <th>Posted Date</th>
                            <th>Status</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="jobsTableBody">
                        <!-- Rows will be dynamically added here -->
                    </tbody>
                </table>
            </div>
        </div>


        <!-- Add Job Modal -->
<div class="modal fade" id="addModal" tabindex="-1" aria-labelledby="addModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="addModalLabel">Add Job</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="addJobForm">
            <div class="mb-3">
              <label for="jobTitle" class="form-label">Job Title</label>
              <input type="text" class="form-control" id="jobTitle" required>
            </div>
            <div class="mb-3">
              <label for="company" class="form-label">Company</label>
              <input type="text" class="form-control" id="company" required>
            </div>
            <div class="mb-3">
              <label for="location" class="form-label">Location</label>
              <input type="text" class="form-control" id="location" required>
            </div>
            <div class="mb-3">
              <label for="postedDate" class="form-label">Posted Date</label>
              <input type="date" class="form-control" id="postedDate" required>
            </div>
            <div class="mb-3">
              <label for="status" class="form-label">Status</label>
              <select class="form-select" id="status" required>
                <option value="Open">Open</option>
                <option value="Closed">Closed</option>
              </select>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button type="button" class="btn btn-primary" id="addJobSubmitBtn">Add Job</button>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Edit Modal -->
  <div class="modal fade" id="editModal" tabindex="-1" aria-labelledby="editModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="editModalLabel">Edit Job</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="editForm">
            <div class="mb-3">
              <label for="editJobId" class="form-label">Job ID</label>
              <input type="text" class="form-control" id="editJobId" readonly>
            </div>
            <div class="mb-3">
              <label for="editJobTitle" class="form-label">Job Title</label>
              <input type="text" class="form-control" id="editJobTitle">
            </div>
            <div class="mb-3">
              <label for="editCompany" class="form-label">Company</label>
              <input type="text" class="form-control" id="editCompany">
            </div>
            <div class="mb-3">
              <label for="editLocation" class="form-label">Location</label>
              <input type="text" class="form-control" id="editLocation">
            </div>
            <div class="mb-3">
              <label for="editPostedDate" class="form-label">Posted Date</label>
              <input type="date" class="form-control" id="editPostedDate">
            </div>
            <div class="mb-3">
              <label for="editStatus" class="form-label">Status</label>
              <select class="form-select" id="editStatus">
                <option value="Open">Open</option>
                <option value="Closed">Closed</option>
              </select>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button type="button" class="btn btn-primary" id="saveChangesBtn">Save Changes</button>
        </div>
      </div>
    </div>
  </div>
    </section>

    <!-- Overview Cards Section -->
    <section class="py-5">
        <div class="container">
            <h2 class="section-title text-center">Overview</h2>
            <div class="row">
                <!-- Card 1: Employees -->
                <div class="col-lg-4 col-md-6 mb-4">
                    <div class="card text-center">
                        <div class="card-body">
                            <h5 class="card-title">Employees</h5>
                            <p class="card-text">Manage all employees in the system.</p>
                            <a href="#" class="btn btn-outline-primary">View Employees</a>
                        </div>
                    </div>
                </div>

                <!-- Card 2: Departments -->
                <div class="col-lg-4 col-md-6 mb-4">
                    <div class="card text-center">
                        <div class="card-body">
                            <h5 class="card-title">Departments</h5>
                            <p class="card-text">Assign employees to departments.</p>
                            <a href="#" class="btn btn-outline-primary">View Departments</a>
                        </div>
                    </div>
                </div>

                <!-- Card 3: Attendance -->
                <div class="col-lg-4 col-md-6 mb-4">
                    <div class="card text-center">
                        <div class="card-body">
                            <h5 class="card-title">Attendance</h5>
                            <p class="card-text">Monitor employee attendance records.</p>
                            <a href="#" class="btn btn-outline-primary">View Attendance</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>


    <!-- Footer Section -->
    <footer class="bg-dark text-white py-4 fixed-bottom">
        <div class="container">
            <div class="row">
                <div class="col-md-6 text-center text-md-start">
                    <p>&copy; 2024 HR System. All Rights Reserved.</p>
                </div>
                <div class="col-md-6 text-center text-md-end">
                    <a href="#" class="text-white me-3">Privacy Policy</a>
                    <a href="#" class="text-white">Contact Us</a>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script type="module" src="assets/js/editProfile.js"></script>




    <script type="module">
      import { getAuth, signOut } from "https://www.gstatic.com/firebasejs/10.13.2/firebase-auth.js";
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.2/firebase-app.js";
      import { getFirestore, collection, getDocs, addDoc, updateDoc, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.13.2/firebase-firestore.js";
  
      const firebaseConfig = {
          apiKey: "AIzaSyBe1HYgEzdcZj0ZOgimd1ODz8B-2aztUYs",
          authDomain: "bank-operations-school.firebaseapp.com",
          projectId: "bank-operations-school",
          storageBucket: "bank-operations-school.appspot.com",
          messagingSenderId: "292213603678",
          appId: "1:292213603678:web:464bf951de870b94baa3cf"
      };
  
      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const auth = getAuth();
      const db = getFirestore(app);
      
      // Fetch jobs from Firestore and populate DataTable
      async function fetchJobs() {
          const jobsCollection = collection(db, "jobs"); // Change "jobs" to your Firestore collection name
          const jobSnapshot = await getDocs(jobsCollection);
          const jobList = jobSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
  
          const jobsTableBody = document.getElementById("jobsTableBody");
          jobsTableBody.innerHTML = ""; // Clear existing rows
  
          jobList.forEach(job => {
              const row = document.createElement("tr");
              row.innerHTML = `
                  <td>${job.id}</td>
                  <td>${job.jobTitle}</td>
                  <td>${job.company}</td>
                  <td>${job.location}</td>
                  <td>${new Date(job.postedDate).toLocaleDateString()}</td>
                  <td>${job.status}</td>
                  <td>
                    <a href="#" class="btn btn-sm btn-outline-primary editBtn" data-id="${job.id}" data-bs-toggle="modal" data-bs-target="#editModal">Edit</a>
                    <a href="#" class="btn btn-sm btn-outline-danger deleteBtn" data-id="${job.id}" data-bs-toggle="modal" data-bs-target="#deleteModal">Delete</a>
                  </td>
              `;
              jobsTableBody.appendChild(row);
          });
  
          // Initialize DataTable
          $('#jobsTable').DataTable();
      }
  
      fetchJobs(); // Initial fetch
  
      // Add job button functionality
      document.getElementById("addJobSubmitBtn").addEventListener("click", async () => {
          const jobTitle = document.getElementById("jobTitle").value;
          const company = document.getElementById("company").value;
          const location = document.getElementById("location").value;
          const postedDate = document.getElementById("postedDate").value;
          const status = document.getElementById("status").value;
  
          // Add job to Firestore
          await addDoc(collection(db, "jobs"), {
              jobTitle,
              company,
              location,
              postedDate,
              status
          });
  
          // Clear form and close modal
          document.getElementById("addJobForm").reset();
          $('#addModal').modal('hide');
  
          // Refresh jobs table
          fetchJobs();
      });
  
      // Edit button functionality
      document.getElementById("jobsTableBody").addEventListener("click", async (e) => {
          if (e.target.classList.contains("editBtn")) {
              const jobId = e.target.getAttribute('data-id');
              const jobRef = doc(db, "jobs", jobId);
              const jobDoc = await getDoc(jobRef);
              const job = jobDoc.data();
  
              // Populate edit form with job data
              document.getElementById("editJobId").value = jobId;
              document.getElementById("editJobTitle").value = job.jobTitle;
              document.getElementById("editCompany").value = job.company;
              document.getElementById("editLocation").value = job.location;
              document.getElementById("editPostedDate").value = job.postedDate.split("T")[0]; // Set input to date format
              document.getElementById("editStatus").value = job.status;
          }
      });
  
      // Save changes button functionality
      document.getElementById('saveChangesBtn').addEventListener('click', async () => {
          const jobId = document.getElementById('editJobId').value;
          const jobTitle = document.getElementById('editJobTitle').value;
          const company = document.getElementById('editCompany').value;
          const location = document.getElementById('editLocation').value;
          const postedDate = document.getElementById('editPostedDate').value;
          const status = document.getElementById('editStatus').value;
  
          // Update job details in Firestore
          const jobRef = doc(db, "jobs", jobId);
          await updateDoc(jobRef, {
              jobTitle,
              company,
              location,
              postedDate,
              status
          });
  
          // Close modal and refresh table
          $('#editModal').modal('hide');
          fetchJobs();
      });
  
      // Logout button functionality
      document.getElementById("logoutBtn").addEventListener("click", async () => {
          try {
              await signOut(auth);
              window.location = "index.html"; // Redirect to login page after sign out
          } catch (error) {
              alert("Logout failed: " + error.message);
          }
      });
  
      // Auto sign out after inactivity (30 seconds)
      let timer;
      const resetTimer = () => {
          clearTimeout(timer);
          timer = setTimeout(async () => {
              await signOut(auth);
              window.location = "index.html";
          }, 30000000); // 30 seconds of inactivity
      };
  
      ['click', 'mousemove', 'keypress', 'scroll', 'touchstart'].forEach(event => {
          window.addEventListener(event, resetTimer);
      });
  
      resetTimer(); // Initialize timer on page load
  </script>

</body>
</html>